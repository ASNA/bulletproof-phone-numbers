<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>Form1.vr</title>
  <link rel="stylesheet" href="..\pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>Form1.vr</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p><img alt="" src="https://asna.com/media/images/phone-numbers-screen-shot-1.png" /></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <p>This ASNA Visual RPG example shows a way to handle telephone data 
entry. Although this example is specific to phone numbers, the concepts
it presents apply to other values such as credit card numbers, social
security numbers, and any other numeric value needing special formatting. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p>The core concept presented here is that the user can enter a telephone number 
in <em>any</em> format. The only restriction is that the characters entered 
must contain a minimum number of digits (10 is the default minimum characters
allowed, Any digits entered over the allowed minimum are assumed to be an 
extension. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>All non-numeric characters (including spaces) are removed from the user-entered
phone number. A simple regular expression used to remove alll non-digits. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <p>Two format strings are used to render the phone number; one with an extension 
and one without. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>&lsquo;{0:(###)} {1:###}-{2:####}&rsquo;
&lsquo;{0:(###)} {1:###}-{2:####} Ext. {3}&rsquo;</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <p>Format strings are region-specific (and to a degree, company-specific). Some 
companies may want to use something other than &lsquo;Ext.&rsquo; to denote an extension. 
The default format strings work with most American phone numbers. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <p>Read this for more on String.Format and its formatting strings:
https://docs.microsoft.com/en-us/dotnet/api/system.string.format?view=netframework-4.8</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <p>Normally, you&rsquo;d store the digits-only value as a string in the database. Upon fetching 
it, it would be rendered with its default formatting string. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <p>As a convenience for North American phone numbers </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <p>Most North American phone numbers comprise an area code, and exchange, and a subscriber number.
Given this phone number &lsquo;(402) 290-2002 Ext. 1234&rsquo;:
  402 = area code
  290 = exchange
 2002 = subscriber number</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <p>After removing all digits, it&rsquo;s an easy task to fetch the parts of the phone number with 
a substring operation. 
ordinal zero-based position 01234567890123 
value                       40229020021234</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <p>0-2 = area code
3-5 = exchange
6-9 = subscriber number
Anything after the zero-based 9th digit is assumed to be the extension.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">Using</span> <span class="nx">System</span>
<span class="nx">Using</span> <span class="nx">System</span><span class="p">.</span><span class="nx">Text</span>
<span class="nx">Using</span> <span class="nx">System</span><span class="p">.</span><span class="nx">Text</span><span class="p">.</span><span class="nx">RegularExpressions</span>
<span class="nx">Using</span> <span class="nx">System</span><span class="p">.</span><span class="nx">Windows</span><span class="p">.</span><span class="nx">Forms</span>

<span class="nx">BegClass</span> <span class="nx">Form1</span> <span class="nx">Extends</span><span class="p">(</span><span class="nx">System</span><span class="p">.</span><span class="nx">Windows</span><span class="p">.</span><span class="nx">Forms</span><span class="p">.</span><span class="nx">Form</span><span class="p">)</span> <span class="nx">Access</span><span class="p">(</span><span class="o">*</span><span class="nx">Public</span><span class="p">)</span> <span class="nx">Partial</span><span class="p">(</span><span class="o">*</span><span class="nx">Yes</span><span class="p">)</span>

    <span class="o">/</span><span class="nx">region</span> <span class="nx">Default</span> <span class="nx">Constructor</span>
    
    <span class="nx">BegConstructor</span> <span class="nx">Access</span><span class="p">(</span><span class="o">*</span><span class="nx">Public</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <p>Required for Windows Form Designer support</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">InitializeComponent</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <p>TODO: Add any constructor code after InitializeComponent call</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">EndConstructor</span>

    <span class="o">/</span><span class="nx">endregion</span>

    
    <span class="nx">BegSr</span> <span class="nx">Form1_Load</span> <span class="nx">Access</span><span class="p">(</span><span class="o">*</span><span class="nx">Private</span><span class="p">)</span> <span class="nx">Event</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">Load</span><span class="p">)</span>
        <span class="nx">DclSrParm</span> <span class="nx">sender</span> <span class="o">*</span><span class="nb">Object</span>
        <span class="nx">DclSrParm</span> <span class="nx">e</span> <span class="nx">System</span><span class="p">.</span><span class="nx">EventArgs</span>

        <span class="nx">textboxPhoneNumber</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="s1">&#39;(402) 290-2002 Ext. 1234&#39;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>Occurs when form is first loaded.
Put form &ldquo;startup&rdquo; code here (ie open files).</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">EndSr</span>

    <span class="nx">BegSr</span> <span class="nx">Form1_FormClosing</span> <span class="nx">Access</span><span class="p">(</span><span class="o">*</span><span class="nx">Private</span><span class="p">)</span> <span class="nx">Event</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">FormClosing</span><span class="p">)</span>
        <span class="nx">DclSrParm</span> <span class="nx">sender</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">Object</span><span class="p">)</span>
        <span class="nx">DclSrParm</span> <span class="nx">e</span> <span class="nx">Type</span><span class="p">(</span><span class="nx">System</span><span class="p">.</span><span class="nx">Windows</span><span class="p">.</span><span class="nx">Forms</span><span class="p">.</span><span class="nx">FormClosingEventArgs</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <p>Occurs when form is closing.  <br />
Put form &ldquo;housecleaning&rdquo; code here (ie close files).</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">EndSr</span>

    <span class="nx">BegSr</span> <span class="nx">buttonFormatPhoneNumber_Click</span> <span class="nx">Access</span><span class="p">(</span><span class="o">*</span><span class="nx">Private</span><span class="p">)</span> <span class="nx">Event</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">buttonFormatPhoneNumber</span><span class="p">.</span><span class="nx">Click</span><span class="p">)</span>
        <span class="nx">DclSrParm</span> <span class="nx">sender</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">Object</span><span class="p">)</span>
        <span class="nx">DclSrParm</span> <span class="nx">e</span> <span class="nx">Type</span><span class="p">(</span><span class="nx">System</span><span class="p">.</span><span class="nx">EventArgs</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <p>The old-school way
This is an in-line way to do things. I think it&rsquo;s a bad way to do it. 
But, looking at first may add to the comprehension of what&rsquo;s happening.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">ParsePhoneNumber</span><span class="p">(</span><span class="nx">textboxPhoneNumber</span><span class="p">.</span><span class="nx">Text</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      <p>After you&rsquo;ve messed with the ParsePhoneNumber routine, comment the line above 
out and comment out the LeaveSr below to see a better way to do it. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">LeaveSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <p>The new-school way
This way puts takes a little more code but it is independent of the UI. 
This makes it easier to test and the class can be used with both 
Windows and Web apps. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">DclFld</span> <span class="nx">phone</span> <span class="nx">Type</span><span class="p">(</span><span class="nx">PhoneNumberParser</span><span class="p">)</span> <span class="nx">New</span><span class="p">(</span><span class="nx">textboxFormatWithoutExtension</span><span class="p">.</span><span class="nx">Text</span><span class="p">,</span> <span class="nx">textboxFormatWithExtension</span><span class="p">.</span><span class="nx">Text</span><span class="p">)</span> 

        <span class="nx">phone</span><span class="p">.</span><span class="nx">ParsePhoneNumber</span><span class="p">(</span><span class="nx">textboxPhoneNumber</span><span class="p">.</span><span class="nx">Text</span><span class="p">)</span> 
        <span class="nx">If</span> <span class="nx">phone</span><span class="p">.</span><span class="nx">InputFormatError</span> 
            <span class="nx">labelErrorMessage</span><span class="p">.</span><span class="nx">Visible</span> <span class="o">=</span> <span class="o">*</span><span class="nx">True</span>
        <span class="nx">Else</span>
            <span class="nx">labelErrorMessage</span><span class="p">.</span><span class="nx">Visible</span> <span class="o">=</span> <span class="o">*</span><span class="nx">False</span>

            <span class="nx">textboxAreaCode</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="nx">phone</span><span class="p">.</span><span class="nx">AreaCode</span>
            <span class="nx">textboxExchange</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="nx">phone</span><span class="p">.</span><span class="nx">Exchange</span>
            <span class="nx">textboxSubscriber</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="nx">phone</span><span class="p">.</span><span class="nx">Subscriber</span>
            <span class="nx">textboxExtension</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="nx">phone</span><span class="p">.</span><span class="nx">Extension</span> 

            <span class="nx">textboxDigitsOnly</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="nx">phone</span><span class="p">.</span><span class="nx">DigitsOnly</span>
            <span class="nx">textboxFormattedPhoneNumber</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="nx">phone</span><span class="p">.</span><span class="nx">FormattedPhoneNumber</span>
        <span class="nx">EndIf</span> 
    <span class="nx">EndSr</span>
    
    <span class="nx">BegSr</span> <span class="nx">ParsePhoneNumber</span>
        <span class="nx">DclSrParm</span> <span class="nx">PhoneNumberAsEntered</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">String</span><span class="p">)</span> 

        <span class="nx">DclFld</span> <span class="nx">DigitsOnly</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">String</span><span class="p">)</span> 
        <span class="nx">DclFld</span> <span class="nx">AreaCode</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Integer4</span><span class="p">)</span> 
        <span class="nx">DclFld</span> <span class="nx">Exchange</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Integer4</span><span class="p">)</span> 
        <span class="nx">DclFld</span> <span class="nx">Subscriber</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Integer4</span><span class="p">)</span> 
        <span class="nx">DclFld</span> <span class="nx">Extension</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Integer4</span><span class="p">)</span> 

        <span class="nx">labelErrorMessage</span><span class="p">.</span><span class="nx">Visible</span> <span class="o">=</span> <span class="o">*</span><span class="nx">False</span>

        <span class="nx">panelParsedData</span><span class="p">.</span><span class="nx">Visible</span> <span class="o">=</span> <span class="o">*</span><span class="nx">False</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      <p>\D is the regex character class for non-digits. 
This removes all non-digit occurrences from the phone number.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">DigitsOnly</span> <span class="o">=</span> <span class="nx">Regex</span><span class="p">.</span><span class="nx">Replace</span><span class="p">(</span><span class="nx">PhoneNumberAsEntered</span><span class="p">,</span> <span class="s1">&#39;\D&#39;</span><span class="p">,</span> <span class="nb">String</span><span class="p">.</span><span class="nx">Empty</span><span class="p">)</span> 
        <span class="nx">If</span> <span class="nx">DigitsOnly</span><span class="p">.</span><span class="nx">Length</span> <span class="o">&lt;</span> <span class="mf">10</span> 
            <span class="nx">labelErrorMessage</span><span class="p">.</span><span class="nx">Visible</span> <span class="o">=</span> <span class="o">*</span><span class="nx">True</span> 
            <span class="nx">panelParsedData</span><span class="p">.</span><span class="nx">Visible</span> <span class="o">=</span> <span class="o">*</span><span class="nx">False</span>
            <span class="nx">LeaveSr</span> 
        <span class="nx">EndIf</span> 

        <span class="nx">panelParsedData</span><span class="p">.</span><span class="nx">Visible</span> <span class="o">=</span> <span class="o">*</span><span class="nx">True</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <p>Pluck out the three fields you want. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">AreaCode</span> <span class="o">=</span> <span class="nx">DigitsOnly</span><span class="p">.</span><span class="nx">Substring</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">3</span><span class="p">)</span>
        <span class="nx">Exchange</span> <span class="o">=</span> <span class="nx">DigitsOnly</span><span class="p">.</span><span class="nx">Substring</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="mf">3</span><span class="p">)</span>
        <span class="nx">SubScriber</span> <span class="o">=</span> <span class="nx">DigitsOnly</span><span class="p">.</span><span class="nx">Substring</span><span class="p">(</span><span class="mf">6</span><span class="p">,</span><span class="mf">4</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <p>If more than 10 digits then an extension is assumed.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">If</span> <span class="nx">DigitsOnly</span><span class="p">.</span><span class="nx">Length</span> <span class="o">&gt;</span> <span class="mf">10</span>         
            <span class="nx">Extension</span> <span class="o">=</span> <span class="nx">DigitsOnly</span><span class="p">.</span><span class="nx">Substring</span><span class="p">(</span><span class="mf">10</span><span class="p">)</span> 
            <span class="nx">textboxFormattedPhoneNumber</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">Format</span><span class="p">(</span><span class="nx">textboxFormatWithExtension</span><span class="p">.</span><span class="nx">Text</span><span class="p">,</span> <span class="nx">AreaCode</span><span class="p">,</span> <span class="nx">Exchange</span><span class="p">,</span> <span class="nx">Subscriber</span><span class="p">,</span> <span class="nx">Extension</span><span class="p">)</span> 
        <span class="nx">Else</span> 
            <span class="nx">textboxFormattedPhoneNumber</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">Format</span><span class="p">(</span><span class="nx">textboxFormatWithoutExtension</span><span class="p">.</span><span class="nx">Text</span><span class="p">,</span> <span class="nx">AreaCode</span><span class="p">,</span> <span class="nx">Exchange</span><span class="p">,</span> <span class="nx">Subscriber</span><span class="p">)</span> 
        <span class="nx">EndIf</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      <p>Show the values. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">textboxAreaCode</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="nx">AreaCode</span>
        <span class="nx">textboxExchange</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="nx">Exchange</span>
        <span class="nx">textboxSubscriber</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="nx">Subscriber</span>
        <span class="nx">textboxExtension</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="nx">Extension</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <p>As a general rule, I would write the phone number to disk as all digits, probably with a long string, but 
a large-enough numeric type would work as well. 
Use String.Format with an appropriate mask. In the class below the two masks needed default to your desired format. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">textboxDigitsOnly</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="nx">DigitsOnly</span>
    <span class="nx">EndSr</span>
    
    
<span class="nx">EndClass</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
